<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FPS2 Multiplayer shooter</title>
    <style>
      html, body {
        overflow: hidden !important;
        cursor: url(./cursors/cursor0.cur), auto !important;
      }
      body {
        background: #fff;
        background: linear-gradient(90deg, #fff 0%, #38b6ff 100%);
      }
      @font-face {
        font-family: "BigShouldersDisplayBold";
        src: url(./fonts/BigShouldersDisplay/BigShouldersDisplay-Bold.ttf);
      }
      @font-face {
        font-family: "BigShouldersDisplayRegular";
        src: url(./fonts/BigShouldersDisplay/BigShouldersDisplay-Light.ttf);
      }
      @font-face {
        font-family: "AgrandirWideBlack";
        src: url(./fonts/Agrandir/AgrandirWideBlack.ttf);
      }
      #heading0 {
        position: relative;
        left: 50%;
        margin: 0;
        width: 45%;
        margin-left: -22.5%;
      }
      #heading1 {
        color: #38b6ff;
        font-family: "BigShouldersDisplayRegular";
        font-size: 5.5vw;
        text-align: center;
      }
      #background {
        position: absolute;
        width: 45%;
        z-index: -1;
        left: 50%;
        margin-left: -22.5%;
      }
      #sidebar {
        position: absolute;
        top: 0;
        height: 100vw !important;
        margin: 0 !important;
        width: 10%;
        z-index: -1;
        margin: 0;
        left: 30px;
      }
      hr {
        width: 50%;
        padding: 0 !important;
        background: #38b6ff;
        outline: none !important;
        border: none !important;
        height: 4px;
        margin-bottom: -2vw !important;
        margin-top: -2vw !important;
      }
      img {
        pointer-events: none !important;
      }
      * {
        user-select: none !important;
        cursor: url(./cursors/cursor0.cur), auto !important;
      }
      button.button {
        position: relative;
        background: #fff;
        width: 50%;
        border: 5px solid #38b6ff;
        text-align: center;
        left: 50%;
        margin-left: -25%;
        margin-top: 10px !important;
        margin-bottom: 10px !important;
        padding: 15px;
        font-family: "AgrandirWideBlack" !important;
        color: #38b6ff;
        font-size: 15px;
        transition: font-size .1s, padding .1s;
      }
      button.button:hover {
        font-size: 20px;
        padding: 12px;
      }
      .cover {
        position: fixed;
        height: 50%;
        width: 100%;
        top: -100%;
        left: 0;
        bottom: 0;
        right: 0;
        margin: 0;
        background: #fff;
        z-index: 9999;
        margin-top: -10px;
        border-bottom: 10px solid #38b6ff;
        padding-top: 100px;
        text-align: center;
      }
      a {
        color: #38b6ff !important;
        font-family: "AgrandirWideBlack";
        border-bottom: 2px solid #38b6ff;
        text-decoration: none !important;
      }
      .swal-modal {
        border-radius: none !important;
        background: #fff;
      }
      .swal-modal * {
        color: #38b6ff;
        font-family: "AgrandirWideBlack";
      }
      .swal-button {
        background: #38b6ff;
        color: #fff !important;
      }
    </style>
    <script type="text/javascript" src="https://npmcdn.com/parse/dist/parse.min.js"></script>
    <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  </head>
  <body>
    <img id="background" src="text-images/rifles.png">
    <img id="sidebar" src="text-images/sidebar.png">
    <img id="heading0" src="text-images/heading.png">
    <hr>
    <h1 id="heading1">MULTIPLAYER SHOOTER</h1>
    <div class="buttons">
      <button class="button" onclick="play(this)">PLAY</button>
      <br>
      <button class="button" onclick="chat()">CHAT</button>
      <br>
      <button class="button" onclick="help()">HELP</button>
    </div>
    <p style="color:#38b6ff;font-family:Arial,Helvetica,sans-serif;font-weight:10;text-align:center;margin-top:0">&copy; 2021-2023 Parking Master</p>
    <div class="cover">
      <span id="close" style="color:#ff4444;font-size:25px" onclick="play()">&times;</span>
      <h1 style="font-family:'BigShouldersDisplayRegular';font-size:50px;color:#38b6ff">&bullet; PLAY &bullet;</h1>
      <br>
      <a href="" onclick="event.preventDefault(); createLobby()">CREATE LOBBY</a>
      <br>
      <a href="" onclick="event.preventDefault(); findLobby()">FIND LOBBY</a>
      <br>
      <a href="" onclick="event.preventDefault(); enterCode()">ENTER CODE</a>
      <br>
    </div>
    <script>
      Parse.initialize("bHe2YiXotGOruwjsso41nGjJEO4NfvcSIx0gUAhX","qnqEwzriDSdqq9LvcxleSthtLusd6HM5HisIaKUN"),Parse.serverURL="https://parseapi.back4app.com/";
      Lobby = new Parse.Object.extend("Lobby");
      createlobbytext = "";
      function code(){let r="";for(let a=1;a<=6;a++)r+=a%2==0?String.fromCharCode(26*Math.random()+65):Math.ceil(9*Math.random());return r}
      function createLobby() {
        swal({
          title: "Create a lobby",
          text: "Enter a lobby name (2-10 characters:)",
          content: "input",
          button: "Create"
        }).then(() => {
          let name = createlobbytext;
          console.log(name)
          if (!name) return;
          if (name.length < 2) return swal("Lobby name should be over 2 characters.");
          if (name.length > 10) return swal("Lobby name should be under 10 characters.");
          let lobby = new Lobby();
          lobby.set("name", name);
          lobby.set("code", document.getElementsByName("code")[0].checked ? code() : "");
          lobby.save().then(() => (console.log("Lobby \"" + name.toString() + "\" saved"), lobby.get("code").length > 0 ? location.assign("src.html?lobby=" + encodeURIComponent(name) + "&code=" + lobby.get("code")) : findLobby(name)));
          createlobbytext = "";
        });
        setTimeout(() => { document.querySelector(".swal-content__input").addEventListener("keyup", () => { createlobbytext = document.querySelector(".swal-content__input").value }) }, 500);
        document.querySelector(".swal-content").innerHTML += `
        <br>
        <input type="checkbox" name="code">
        <label for="code">Players have to enter a code</label>
        `;
      }
      function findLobby(selected) {
        (async() => {
          let e = !1;
          const t = Parse.Object.extend("Lobby");
          const n = new Parse.Query(t);
          const s = await n.find();
          for (let t = 0; t < s.length; t++) {
            const n = Parse.Object.extend("Lobby");
            new Parse.Query(n).get(s[t].id).then((t => {
              const n = { name: t.get("name"), time: t.get("createdAt"), code: t.get("code") };
              if (e) {
                document.querySelector(".swal-content").innerHTML += n.code.length > 0 ? "" : '<div class="lobby" id="' + btoa(encodeURIComponent(n.name)).replace(/\=/gi,"") + '">"<a onclick="location.assign(\'./src.html?lobby=' + encodeURIComponent(n.name) + '\')">' + (n.name.trim() == "" ? ("(blank space)") : n.name.trim()) + '</a>" : ' + n.time.toString().split(" ").reverse().splice(4).reverse().splice(1).join(" ").split(":").reverse().splice(1).reverse().join(":") + "</div>";
              } else {
                e = !0;
                let content = document.createElement("div");
                content.innerHTML = n.code.length > 0 ? "" : '<br><div class="lobby" id="' + btoa(encodeURIComponent(n.name)).replace(/\=/gi,"") + '">"<a onclick="location.assign(\'./src.html?lobby='+encodeURIComponent(n.name)+'\')">' + n.name+'</a>" : ' + n.time.toString().split(" ").reverse().splice(4).reverse().splice(1).join(" ").split(":").reverse().splice(1).reverse().join(":") + "</div>";
                swal({
                  title: "FIND A LOBBY",
                  content: content
                });
              }
            }));
            setTimeout(() => {
              if (selected) {
                document.querySelector("#"+btoa(encodeURIComponent(selected)).replace(/(\=)/gi,"")).style.outline = "2px solid #38b6ff";
                document.querySelector("#"+btoa(encodeURIComponent(selected)).replace(/(\=)/gi,"")).scrollIntoView();
              }
            }, 1000);
          }
        })();
      }
      function enterCode() {
        swal({
          title: "Enter a code",
          text: "This will join a lobby with the selected code. Example: \"XXXXXX\"",
          content: "input",
          button: "Join"
        }).then((name) => {
          !name || swal({
            title: "Searching...",
            text: "Attempting to find lobby",
            button: "Cancel"
          });
          !name || (async () => {
            let e = !1;
            let code = name.toUpperCase();
            let codes = {};
            const t = Parse.Object.extend("Lobby");
            const n = new Parse.Query(t);
            const s = await n.find();
            let pause = false;
            for (let t = 0; t < s.length; t++) {
              let ot = t;
              const n = Parse.Object.extend("Lobby");
              new Parse.Query(n).get(s[t].id).then((t => {
                const n = { name: t.get("name"), code: t.get("code") };
                if (e) {
                  codes[n.name] = (n.code);
                } else {
                  e = !0;
                }
                console.log(n.code, code);
                console.log(n.code == code);
                if (!pause) (n.code == (code) ? (pause = true, swal({ title: "Lobby found", text: "Do you want to join the lobby \"" + n.name + "\"?", buttons: ["Yes", "No"] }).then((e) => !e && location.assign("./src.html?lobby=" + encodeURIComponent(n.name) + "&code=" + code))) : ot + 1 >= s.length && swal({ title: "Lobby not found", text: "This lobby does not exist." }));
              }));
            }
          })();
        });
      }
      didPlay = false;
      function play(button) {
        if (!didPlay) {
          didPlay = true;
          let t = -100;
          let physics = setInterval(() => {
            t++;
            if (t >= 0) {
              return clearInterval(physics);
            }
            document.querySelector(".cover").style.top = t + "%";
          });
          return;
        }
        didPlay = false;
        let t = 0;
        let physics = setInterval(() => {
          t--;
          if (t <= -100) {
            return clearInterval(physics);
          }
          document.querySelector(".cover").style.top = t + "%";
        });
      }
    </script>
  </body>
</html>